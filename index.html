<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Charcuter√≠a</title>

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#c84c4c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Jam√≥n Calc">

    <!-- Icons -->
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icon-512.png">
    <link rel="apple-touch-icon" href="icon-512.png">

    <!-- Styles -->
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="container">
        <header>
            <h1>Calculadora de Charcuter√≠a</h1>
            <p>Estimaci√≥n de costos y rentabilidad por gramos</p>
        </header>

        <main class="card">
            <section class="controls">
                <div class="control-group">
                    <label for="jamon-type">Producto</label>
                    <div class="select-wrapper">
                        <select id="jamon-type">
                            <!-- Productos Ahumados -->
                            <optgroup label="üçñ Productos Ahumados">
                                <option value="JAMON-A">Jam√≥n Selva Negra</option>
                                <option value="TOCINETA">Tocineta Ahumada</option>
                                <option value="LOMO-AHUMADO">Lomo Ahumado</option>
                                <option value="CHULETA-AHUMADA">Chuleta Ahumada</option>
                                <option value="COSTILLA-AHUMADA">Costilla Ahumada</option>
                            </optgroup>

                            <!-- Productos Curados -->
                            <optgroup label="ü•ì Productos Curados">
                                <option value="COPPA" selected>Coppa</option>
                                <option value="PITINA">Pitina</option>
                                <option value="JAMON-NEGRO">Jam√≥n Negro</option>
                                <option value="CHORIZO-CURADO">Chorizo Curado</option>
                            </optgroup>

                            <!-- Productos Frescos -->
                            <optgroup label="üê∑ Productos Frescos">
                                <option value="CHORIZO-COLONIERO">Chorizo Coloniero</option>
                                <option value="RODILLA-CERDO">Rodilla de Cerdo</option>
                            </optgroup>
                        </select>
                    </div>
                </div>

                <div class="control-group">
                    <label for="quantity-grams">Cantidad (Gramos)</label>
                    <div class="input-wrapper">
                        <input type="number" id="quantity-grams" value="1000" step="100" min="100" max="10000">
                        <span class="currency-label">g</span>
                    </div>
                    <div class="range-wrapper">
                        <input type="range" id="range-grams" min="100" max="10000" step="100" value="1000">
                    </div>
                    <div class="quantity-info">
                        <span id="quantity-display">1.0 kg</span>
                    </div>
                </div>

                <div class="divider"></div>

                <div class="control-group">
                    <label for="exchange-rate">Tasa de Cambio (Bs/USD)</label>
                    <div class="input-wrapper">
                        <input type="number" id="exchange-rate" value="247.00" step="0.10" min="1">
                        <span class="currency-label">Bs</span>
                    </div>
                </div>

                <div class="control-group">
                    <label for="profit-margin">Margen de Ganancia (%)</label>
                    <div class="input-wrapper">
                        <input type="number" id="profit-margin" value="30" step="1" min="0" max="99">
                        <span class="currency-label">%</span>
                    </div>
                </div>

                <div class="button-group">
                    <button id="btn-config-prices" class="btn-secondary">
                        <span>‚öôÔ∏è</span> Precios
                    </button>
                    <button id="btn-config-recipes" class="btn-secondary">
                        <span>üìù</span> Recetas
                    </button>
                    <button id="btn-config-overhead" class="btn-secondary">
                        <span>üí∞</span> Gastos
                    </button>
                </div>
            </section>

            <section class="results">
                <h2>Resultados de Producci√≥n</h2>

                <div class="result-grid">
                    <div class="result-item">
                        <span class="label">Costo Ingredientes</span>
                        <span class="value" id="cost-ingredients">$0.00</span>
                    </div>
                    <div class="result-item">
                        <span class="label">Gastos Asociados</span>
                        <span class="value" id="cost-overhead">$0.00</span>
                        <span class="subtext">Energ√≠a + Mano de Obra + Generales</span>
                    </div>
                    <div class="result-item highlight">
                        <span class="label">Costo Total Producci√≥n</span>
                        <span class="value" id="cost-total">$0.00</span>
                    </div>
                </div>

                <div class="divider"></div>

                <h2>Rentabilidad Estimada</h2>
                <div class="profit-stats">
                    <div class="stat-box">
                        <span class="stat-label">Precio Venta (USD)</span>
                        <span class="stat-value" id="price-usd">$0.00</span>
                    </div>
                    <div class="stat-box profit">
                        <span class="stat-label">Ganancia (USD)</span>
                        <span class="stat-value" id="profit-usd">$0.00</span>
                    </div>
                    <div class="stat-box local">
                        <span class="stat-label">Precio Venta (Bs)</span>
                        <span class="stat-value" id="price-bs">Bs 0.00</span>
                    </div>
                </div>

                <div class="divider"></div>

                <h2>Precios por Porci√≥n</h2>
                <div class="portion-prices">
                    <div class="portion-row">
                        <span class="portion-label">Precio por 100g</span>
                        <div class="portion-values">
                            <span class="portion-value" id="price-per-100g-usd">$0.00</span>
                            <span class="portion-value bs" id="price-per-100g-bs">Bs 0.00</span>
                        </div>
                    </div>
                    <div class="portion-row">
                        <span class="portion-label">Precio por 250g</span>
                        <div class="portion-values">
                            <span class="portion-value" id="price-per-250g-usd">$0.00</span>
                            <span class="portion-value bs" id="price-per-250g-bs">Bs 0.00</span>
                        </div>
                    </div>
                    <div class="portion-row">
                        <span class="portion-label">Precio por 500g</span>
                        <div class="portion-values">
                            <span class="portion-value" id="price-per-500g-usd">$0.00</span>
                            <span class="portion-value bs" id="price-per-500g-bs">Bs 0.00</span>
                        </div>
                    </div>
                    <div class="portion-row highlight">
                        <span class="portion-label">Precio por Kg</span>
                        <div class="portion-values">
                            <span class="portion-value" id="price-per-kg-usd">$0.00</span>
                            <span class="portion-value bs" id="price-per-kg-bs">Bs 0.00</span>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal Precios -->
    <div id="price-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Actualizar Precios (USD)</h3>
                <button id="close-modal" class="close-btn">&times;</button>
            </div>

            <!-- Buscador -->
            <div class="modal-search">
                <div class="input-wrapper">
                    <input type="text" id="price-search" placeholder="üîç Buscar ingrediente...">
                </div>
            </div>

            <div class="modal-body" id="prices-list">
                <!-- Prices will be injected here by JS -->
            </div>
            <div class="modal-footer">
                <button id="save-prices" class="btn-primary">Guardar Cambios</button>
            </div>
        </div>
    </div>

    <!-- Modal Recetas -->
    <div id="recipe-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Editar Receta (<span id="recipe-modal-title"></span>)</h3>
                <button id="close-recipe-modal" class="close-btn">&times;</button>
            </div>
            <div class="modal-body" id="recipe-list">
                <!-- Recipe ingredients will be injected here -->
            </div>
            <div class="modal-footer">
                <button id="save-recipe" class="btn-primary">Guardar Receta</button>
            </div>
        </div>
    </div>

    <!-- Modal Gastos Asociados -->
    <div id="overhead-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Configurar Gastos Asociados</h3>
                <button id="close-overhead-modal" class="close-btn">&times;</button>
            </div>
            <div class="modal-body" id="overhead-list">
                <div class="price-row">
                    <label>Gasto de Energ√≠a (USD por 100g)</label>
                    <div class="input-wrapper">
                        <input type="number" id="overhead-energy" value="0.05" step="0.01">
                        <span class="currency-label">$</span>
                    </div>
                </div>
                <div class="price-row">
                    <label>Mano de Obra (USD por kg)</label>
                    <div class="input-wrapper">
                        <input type="number" id="overhead-labor" value="1.50" step="0.01">
                        <span class="currency-label">$</span>
                    </div>
                </div>
                <div class="price-row">
                    <label>Gastos Generales (%)</label>
                    <div class="input-wrapper">
                        <input type="number" id="overhead-general" value="10" step="1">
                        <span class="currency-label">%</span>
                    </div>
                </div>
                <div class="price-row">
                    <label>Otros Gastos (USD fijos)</label>
                    <div class="input-wrapper">
                        <input type="number" id="overhead-other" value="0.00" step="0.01">
                        <span class="currency-label">$</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="save-overhead" class="btn-primary">Guardar Gastos</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>

    <!-- PWA Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then((registration) => {
                        console.log('‚úÖ Service Worker registrado:', registration.scope);
                    })
                    .catch((error) => {
                        console.log('‚ùå Error al registrar Service Worker:', error);
                    });
            });
        }
    </script>
</body>

</html>